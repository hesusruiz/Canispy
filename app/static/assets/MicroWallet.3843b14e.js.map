{"version":3,"file":"MicroWallet.3843b14e.js","sources":["../../src/pages/MicroWallet.js"],"sourcesContent":["import { log } from '../log'\r\nimport { AbstractPage, register } from '../components/AbstractPage'\r\n\r\nregister(\"MicroWallet\", class MicroWallet extends AbstractPage {\r\n\r\n    constructor(id) {\r\n        super(id)\r\n    }\r\n\r\n    async enter() {\r\n        let html = this.html\r\n\r\n        // We can receive QRs via the URL or scanning with the camera\r\n\r\n        // If URL specifies a QR then\r\n        //     check it and store in local storage\r\n        //     clean the URL and reload the app\r\n        // If URL is clean (initially or after reloading)\r\n        //     retrieve the QR from local storage and display it\r\n\r\n        // Check if we received a certificate via the URL\r\n        // The URL should be: https://host:port/?eudcc=QRCodeInBase64Encoding\r\n        // The QRCodeInBase64Encoding is the long string representing each QR code\r\n        let params = new URLSearchParams(document.location.search.substring(1));\r\n        let eudcc = params.get(\"eudcc\");\r\n    \r\n        // QR code found in URL. Process and display it\r\n        if (eudcc !== null) {\r\n            // Decode from Base64url\r\n            eudcc = atob(eudcc)\r\n            console.log(\"EUDCC received:\", eudcc)\r\n\r\n            // Ask the user to accept the certificate\r\n            await this.gotoPage(\"AskUserToStoreQR\", eudcc)\r\n            return;\r\n        \r\n        }\r\n    \r\n        // Check if we have a certificate in local storage\r\n        let qrContent = window.localStorage.getItem(\"MYEUDCC\")\r\n        if (qrContent !== null) {\r\n            // Display the certificate\r\n            await this.gotoPage(\"DisplayMyHcert\", qrContent)\r\n            return;        \r\n        }\r\n\r\n        // We do not have a QR in the local storage\r\n        this.render(html`\r\n            <div id=\"hcertFailed\" class=\"w3-panel bkg-fail\">\r\n                <h2>${T(\"There is no certificate.\")}</h2>\r\n            </div>\r\n       `)\r\n        return\r\n    }\r\n})\r\n"],"names":[],"mappings":"0EAGA,EAAS,cAAe,aAA0B,EAAa,CAE3D,YAAY,EAAI,CACZ,MAAM,QAGJ,QAAQ,CACV,GAAI,GAAO,KAAK,KAcZ,EAAQ,AADC,GAAI,iBAAgB,SAAS,SAAS,OAAO,UAAU,IACjD,IAAI,SAGvB,GAAI,IAAU,KAAM,CAEhB,EAAQ,KAAK,GACb,QAAQ,IAAI,kBAAmB,GAG/B,KAAM,MAAK,SAAS,mBAAoB,GACxC,OAKJ,GAAI,GAAY,OAAO,aAAa,QAAQ,WAC5C,GAAI,IAAc,KAAM,CAEpB,KAAM,MAAK,SAAS,iBAAkB,GACtC,OAIJ,KAAK,OAAO;AAAA;AAAA,sBAEE,EAAE;AAAA;"}